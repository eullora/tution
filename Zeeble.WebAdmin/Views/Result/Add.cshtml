@using Zeeble.Shared.Entities
@{
    ViewData["Title"] = "Add Result";
    var exam = ViewData["ExamRow"] as Exam;
    var subjectList = ViewData["SubjectRows"] as IEnumerable<Subject>;

}
@section Styles {
    <partial name="_Select2Css" />
}
<div class="container">
    <div class="row justify-content-center">
        <h3 class="mt-4 mb-5">@exam.Name</h3>

        <div class="col-lg-12">
            <div class="row mb-3">
                <form asp-controller="result" asp-action="add" method="post" enctype="multipart/form-data">
                    <input type="hidden" name="ExamId" value="@exam.Id" />
                    <input type="hidden" name="SubjectColumns" value="" id="subjectColumns" />

                    <div class="col-md-12 mt-3">
                        <label for="resultFile" class="mb-2 mt-3">Result CSV File *</label>
                        <input class="form-control" id="resultFile" required type="file" name="resultFile">
                    </div>

                    <div class="col-md-12 mt-3 mb-4" id="divHeaders"></div>


                    <div class="col-md-12 mt-3">
                        <label for="subjectList" class="mb-2 mt-3">Subjects *</label>
                        <select class="form-select" multiple id="subjectList" name="SubjectIds" required>
                            <option value=""></option>
                            @foreach (var subject in subjectList)
                            {
                                <option value="@subject.Id">@subject.Name</option>
                            }
                        </select>
                    </div>

                    <div class="mt-4 mb-0">
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_Select2Js" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script type="application/json" id="scriptSubjects">@Html.Raw(ViewData["SubjectJson"])</script>    
    <script src="~/js/add-results.js"></script>
    <script type="text/javascript">        
        activeAdminMenu('#exam');
    </script>
}